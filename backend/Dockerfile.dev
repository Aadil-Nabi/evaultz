# ─── Dev Dockerfile for Backend (hot reload) ───
FROM golang:1.25.1 AS dev

WORKDIR /app

# Optional: bypass TLS issues if behind corporate proxy
ENV GOPROXY=direct
ENV GOSUMDB=off
ENV GOINSECURE=*
ENV GIT_SSL_NO_VERIFY=1

# Install Air (hot reload) - use the new module path
RUN go install github.com/air-verse/air@latest

# Copy mod files and download deps (cache)
COPY go.mod go.sum ./
RUN go mod download

# Copy Air config first
COPY .air.toml ./
# Copy source
COPY . .

# Expose backend port
EXPOSE 8082

# Run with Air
CMD ["air", "-c", ".air.toml"]
